# FM50x RFID Reader Protocol Documentation

## Connection
UART (QinHeng Electronics USB Single Serial USB) on /dev/ttyACM0

38400 8N1, parity: none


## Command Format
Command and return message is transmitted as ASCII format. All command is start with a command character and arguments (if any, in hexadecimal units) and stop with a \<CR\>(0x0D hex).

Response message is start with a \<LF\>(0x0A hex), command first character and stop with a \<CR\>\<LF\>

If command is none match, return message will be \<LF\>X\<CR\>\<LF\>.

Examples:
```
>: <LF>S<CR>
<: <LF>S01234567<CR><LF>
```

### RFID Command table:
> Note:
> + queries are encapsulated in `<LF>________<CR>`
> + responses are encapsulated in `<LF>_______<CR><LF>`

**Device commands:**
| Command*                                                                                                                                                                                                          | Return Message**                                                                                                                                                                                                                                                 | Description                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| `V`                                                                                                                                                                                                                 | `Vxxyy,<message>` xx: major version number yy: minor version number `<message>`: other info.                                                                                                                                                                         | display reader firmware version |
| `S`                                                                                                                                                                                                                 | `S01234567` 01234567 is reader ID                                                                                                                                                                                                                                  | display reader ID               |

**read tag operations:**
| Command*                                                                                                                                                                                                          | Return Message**                                                                                                                                                                                                                                                 | Description                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| `Q`                                                                                                                                                                                                                 | `Q<none or EPC>` `<none or EPC>` none: no tag in RF field EPC: PC+EPC+CRC16                                                                                                                                                                                          | display tag EPC ID                                                                               |
| `R<bank>,<address>,<length>`. `<bank>` memory bank 0: reserved 1: EPC 2: TID 3: USER `<address>` start address 0 ~ 3FFF `<length>` read word length 1 ~ 1E                                                                 | R\<none or read data\> or \<error code\> \<none or read data\> none: no tag in RF field \<Error code\> 0: other error 3: memory overrun 4: memory locked B: Insufficient power F: Non-specific error                                                                     | read tag memory data                                                                             |
| `U`                                                                                                                                                                                                                 | `U<none or EPC>` `<none or EPC>` none: no tag in RF field EPC: PC+EPC+CRC16                                                                                                                                                                                          | Multi-TAG read EPC                                                                               |
| `T<bank>,<bit address>,<bit length >,<bit data >` `<bank>` memory bank 0: reserved 1: EPC 2: TID 3: USER `<bit address>` start bit address 0~3FFF `<bit length >` select bit length 1~60 `<bit data >` select bit mask data | T                                                                                                                                                                                                                                                                | Select matching tag                                                                              |
| `UR: U<slot Q>, R<band>,<address>, <length>` Slot Q: 0~10 `<bank>` memory bank 0: reserved 1: EPC 2: TID 3: USER `<address>` start word address 0 ~ 3FFF `<length>` read word length 1 ~ 1E                              | `U<EPC>,R<DATA>` or `<error code>` EPC= PC+EPC+CRC16 DATA= read data Error code: 0: other error 3: memory overrun 4: memory locked B: Insufficient power F: Non-specific error                                                                                     | Multi-Band data read with EPC for multi-Tag read                                                 |
| `QR: Q , R<band>,<address>,<length>` `<bank>` memory bank 0: reserved 1: EPC 2: TID 3: USER `<address>` start word address 0 ~ 3FFF `<length>` read word length 1 ~ 1E                                                    | `Q<EPC>,R<DATA>` or `<error code>` EPC= PC+EPC+CRC16 DATA= read data Error code: 0: other error 3: memory overrun 4: memory locked B: Insufficient power F: Non-specific error                                                                                    | Multi-Band data read with EPC for single-Tag read                                                |

**write tag operations:**
| Command*                                                                                                                                                                                                          | Return Message**                                                                                                                                                                                                                                                 | Description                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| `W<bank>,<address>, <length>,<data>` `<bank>` memory bank 0: reserved 1: EPC 2: TID 3: USER `<address>` start address 0 ~ 3FFF `<length>` write words length 1 ~ 1E                                                       | `W<none or <OK>>` or `<error code>` `<none or <OK>>` none: no tag in RF field `<OK>`: written ok `<error code>` 0: other error 3: memory overrun 4: memory locked   B: Insufficient power F: Non-specific error Z00~Z1F: words write 3Z00~3Z1F: error code and words write | write data to tag memory                                                                         |
| `K<password>,<recom>` `<password>` kill password 00000000~FFFFFFFF `<recom>` recommissioning 0~7                                                                                                                        | `K<none or <OK>>` or `<error code>` `<none or <OK>>` none: no tag in RF field `<OK>`: kill ok `<error code>` 0: other error 3: memory overrun 4: memory locked   B: Insufficient power F: Non-specific error                                                               | kill tag                                                                                         |
| `L<mask>,<action>` `<mask>` lock mask 000~3FF `<action>` lock action 000~3FF                                                                                                                                            | `L<none or <OK>>` or `<error code>` `<none or <OK>>` none: no tag in RF field `<OK>`: lock ok `<error code>` 0: other error 3: memory overrun 4: memory locked B: Insufficient power F: Non-specific error                                                                 | lock memory                                                                                      |
| `P<password>` `<password>` access password   00000000~FFFFFFFF                                                                                                                                                        | `P`                                                                                                                                                                                                                                                                | set access password for R W L command, one time use                                              |

**Reader configuration commands:**
| Command*                                                                                                                                                                                                          | Return Message**                                                                                                                                                                                                                                                 | Description                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| `G1` `G0` `G2`                                                                                                                                                                                                          | `G1` `G0` `G2`                                                                                                                                                                                                                                                         | Start command logging End command logging Run logging commands For external TACT switch function |
| `N0,00` read RFID Reader power `N1, <value>` set RFID Reader power (-2~25dBm) `<value>` 00~1B                                                                                                                           | `N<value>` `<NULL>`                                                                                                                                                                                                                                                 | Read/Set RFID Reader power level                                                                 |
| `N4,00` read Regulation `N5, <value>` set Regulation `<value>` 01~08 01: US 902~928   02: TW 922~928   03: CN 920~925   04: CN2 840~845   05: EU 865~868   06: JP 916~921   07: KR 917~921     08: VN 918~923           | `N<value>` `<value>` 01: US 902~928   02: TW 922~928   03: CN 920~925   04: CN2 840~845   05: EU 865~868   06: JP 916~921   07: KR 917~921 08: VN 918~923                                                                                                            | Read/Set Frequency Range                                                                         |
| `N6,00` get GPIO configuration `N7,<value>` set GPIO configuration `<value>`mask and setting mask: first digi 4+2+1 4: pin10 2: pin11 1: pin14 setting: second digi 4+2+1 4: pin10 out 2: pin11 out 1: pin14 out        | `N<value>` `<value>` 4+2+1 4: pin10 out 2: pin11 out 1: pin14 out                                                                                                                                                                                                    | get/set GPIO input/output configuration                                                          |
| `N8,00` read GPIO pins `N9,<value>` write GPIO pins `<value>`mask and setting mask: first digi 4+2+1 4: pin10 2: pin11 1: pin14 setting: second digi 4+2+1 4: pin10 high 2: pin11 high 1: pin14 high                    | `N<value>` `<value>` 4+2+1 4: pin10 high level 2: pin11 high level 1: pin14 high level                                                                                                                                                                               | read/write GPIO pins                                                                             |
| `NA,<value>` setting UART Baud Rate `<value>` 0: 4800  1: 9600  2: 14400  3: 19200  4: 38400  5: 57600  6: 115200  7: 230400                                                                                       | `N<value>` `<value>` 0: 4800  1: 9600  2: 14400  3: 19200  4: 38400  5: 57600  6: 115200  7: 230400                                                                                                                                                                | Setting UART Baud Rate. After getting the reply,Baud Rate will be changed                        |


### Examples:

1. Read TID memory bank, start address at 0, read 4 words length, TID data is `0x1234567890`
```
>: <LF>R2,0,4<CR>
<: <LF>R123456789ABCDEF0<CR><LF>
```
2. Write USER memory bank, start address at 12, write 2 word length, write data is `0xAAAABBBB`
```
>: <LF>W3,C,2,AAAABBBB<CR>
<: <LF>W<OK><CR><LF>
```